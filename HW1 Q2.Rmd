---
title: "STATS 413 HW1 Q2, Q3e"
author: "Vy Dang"
date: '2024-09-03'
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(ggplot2)
```


### Problem 2

For historical reasons the US has a system of taxing homeowners to fund a large fraction of local in-
frastructure such as local primary, middle and high schools, town and county administrations, and town
and county roads. The tax, called “property tax”, is based on an assessment (estimation, determination) of
the value of each residence (home) and the lot (land) that belongs to it. Because the assessments become
outdated after a few years, towns have to hire assessors and update the assessments every so often.
There are of course several factors that play a role in assessing the value of a property, such as square feet
of livable area, size of the lot (land), quality and condition of the building, and desirability of the area. We
will only consider square feet of livable area. The following exercise can be used to check for any property
whether its assessed value is in line or out of line with other properties of similar size in terms of livable
area. This data set is called Residential Property Assessments.csv.

```{r}
data <- read.csv('Residential_Property_Assessments.csv')
```

a. (2 pts) Show a scatterplot of Assessment against Livable Area (i.e., Assessment is the y variable, and
Livable Area is the x variable). Add a main title along with axis labels.

```{r}
data |> ggplot(aes(x = Livable.Area, y = Assessment)) + geom_point() +
  labs(title = "Assessment vs Livable Area",
       x = "Livable Area (sq ft)",
       y = "Assessment ($)")
```

b. (1 pt) Based on the scatterplot, is the association approximately linear?

> The association is approximately linear based on the scatterplot.

c. (4 pts) Use R to find the equation for the regression line with Assessment as the response variable and
Living Area as the predictor variable. Report the resulting equation (rather than simply showing R
output).

```{r}
model <- lm(Assessment~Livable.Area, data = data)
model
coefficients <- coef(model)
intercept <- coefficients[1]
slope <- coefficients[2]
paste("Assessment =", round(intercept,2), "+", round(slope,2), "* Livable Area" )
```
d. (3 pts) Interpret the slope. Initially, do so first formally according to the formulation from class. Then,
give an informal interpretation in terms of the average value of a square foot of livable area.

> Formal interpretation: 
> Equation: Assessment = β0 + β1 * Livable Area

> Holding all other variables equal (ceteris paribus), if two properties differ in their livable area by 1 square foot, then we expect their assessments to differ by β1 units on average. β1 represents the change in the expected assessment for a one-unit increase in the livable area given that other factors are held constant.

> Informal interpretation: For every additional square foot of livable area, the property assessment increases by 180.8 dollars on average. This means that a larger house with more livable area will have a higher assessed value. Each additional square foot is valued at approximately 180.8 dollars in terms of property assessment.

e. (3 pts) Interpret the intercept. Initially, do so formally according to the formulation in class. Is there
an informal interpretation of the intercept in the context of this problem that might be meaningful,
despite the fact that it represents an extrapolation?

> Formal interpretation: The intercept β0 in a linear regression model is interpreted as the expected value of the response variable (Assessment) when all predictor variables (Livable Area) are zero. Mathematically it represents the value of (E(Y|X=0)). The intercept β0 would be the assessment value predicted for a property with zero square feet of livable area. So formally, (β0 = 168518.6) means that the expected assessment value for a property with zero square feet of livable area is 168518.6 dollars

> Informal interpretation: Despite the fact that a property with zero square feet of livable area is unrealistic, this value can representthe starting point or base value of the property due to land value or fixed costs that are independent of the livable area.

f. (2 pts) What fraction of variation in Assessment is accounted for by Livable Area through our regression
model? Report the relevant quantity from the R output. Finally, what fraction of variation is accounted
for by other factors besides livable area, such as differences in lot size, condition and quality of the
building, and viability of the area?

```{r}
summary(model)
```
> Fraction of variation in Assessment accounted for by Livable Area ((R^2)): 0.7893. 

> 78.93% of the variation in the Assessment (property value) is explained by the Livable Area in this regression model.

> Fraction of variation in Assessment accounted for by other factors: 1 - R^2 = 1 - 0.7893 = 0.2107. 

> 21.07% of the variation in Assessment is due to other factors besides Livable Area.

g. (2 pts) Point prediction: Based on the fitted equation, what can you say about the predicted price for
a residence with 2,500 square feet of livable area? Use R to calculate this and show your code.

```{r}
new_data <- data.frame(Livable.Area=2500)
predict_2500_sqft <- predict(model, newdata = new_data)
predict_2500_sqft
```
h. (3 pts) Predict the difference in assessed value for two residences where one residence is 200 square feet
larger than the other. If you cannot complete your calculation with the information provided, explain
why not.

> Here we use beta-1 to calculate. The slope can directly be scaled to predict the difference for any unit change in the independent variable.

```{r}
difference_in_assessment <- slope * 200
difference_in_assessment
```
> The difference in assessed value for two residences where one is 200 square feet larger than the other would be $36,164.05.

### Problem 3

e. (4 pts) Using the regression of Assessment on Livable Area you conducted in Problem 2, illustrate your
findings in Problem 3, parts b) and d). That is, produce code that shows that for the regression of
Assessment on Livable Area:
• The residuals from this regression have mean zero.
• The predicted values and residuals from this regression are uncorrelated.
[Note: you may see very small but nonzero numbers come up in your numerical verifications, for
instance 2 × 10−16 or something of a similar magnitude. Consider these as true zeroes - the departures
from zero are artifacts of machine precision.]

```{r}
residuals <- residuals(model)
fitted_values <- fitted(model)
mean_residuals <- mean(residuals)
mean_residuals
```
```{r}
correlation_fitted_residuals <- cor(fitted_values, residuals)
correlation_fitted_residuals
```
```{r}
ggplot(data, aes(x = fitted_values, y = residuals)) +
  geom_point() +
  geom_hline(yintercept = 0, linetype="dashed", color="red") +
  labs(title = "Residuals vs Fitted Values",
       x = "Fitted Values",
       y = "Residuals")
```

```{r}
ggplot(data.frame(residuals = residuals), aes(x = residuals)) +
  geom_histogram(bins = 30, color = "black", fill = "skyblue") +
  geom_vline(aes(xintercept = mean_residuals), color = "red", linetype = "dashed") +
  labs(title = "Histogram of Residuals",
       x = "Residuals",
       y = "Frequency")
```

